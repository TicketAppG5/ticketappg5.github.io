<!DOCTYPE html>
<html>
<head>
  <title>Redireccionar a Ticket App</title>

  <!-- Meta tags para compartir en Twitter -->
  <meta property="og:title" content="Ticketapp">
  <meta property="og:description" content="Ticketapp">
  <meta property="og:image" itemprop="image" content="https://img.freepik.com/vector-premium/ilustracion-vector-grafico-personaje-dibujos-animados-agenda-calendario-eventos-calendario_516790-1280.jpg?w=1380">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Meta tags para compartir en WhatsApp -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Ticketapp">
  <!-- <meta property="og:url" content="ticketapp://Home"> -->
  <meta property="og:image:width" content="600">
  <meta property="og:image:height" content="315">
  <meta property="og:updated_time" content="1440432930" />
</head>
<body>
<script>
  const response = await fetch('https://tickectapp-web-service.onrender.com/api/events')
  const data = await response.json()

  const title = data.name;
  const description = data.description;
  const image = data.photos.length
    ? "https://img.freepik.com/vector-premium/ilustracion-vector-grafico-personaje-dibujos-animados-agenda-calendario-eventos-calendario_516790-1280.jpg?w=1380"
    : data.photos[0];

  // Establecer los valores en los meta tags
  document.querySelector('meta[property="og:title"]').setAttribute("content", title);
  document.querySelector('meta[property="og:description"]').setAttribute("content", description);
  document.querySelector('meta[property="og:image"]').setAttribute("content", title);

  function obtenerParametroConsulta(nombre) {
    nombre = nombre.replace(/[\[\]]/g, "\\$&");
    let regex = new RegExp("[?&]" + nombre + "(=([^&#]*)|&|#|$)"),
        resultados = regex.exec(window.location.href);
    if (!resultados) return null;
    if (!resultados[2]) return '';
    return decodeURIComponent(resultados[2].replace(/\+/g, " "));
  }

  function redireccionar() {
    let eventId = obtenerParametroConsulta('eventId');
    // Verificar si la aplicaci칩n Ticket App est치 instalada
    if (navigator.userAgent.match(/Android/i) && window.location.href.indexOf("intent") === -1) {
      if (eventId) {
        window.open(`ticketapp://EventDetail?eventId=${eventId}`);
        // window.location.replace(`ticketapp://EventDetail?eventId=${eventId}`);
        // window.location.href = `ticketapp://EventDetail?eventId=${eventId}`;
      } else {
        window.open("ticketapp://Home");
        // window.location.replace("ticketapp://Home");
        // window.location.href = "ticketapp://Home";
      }
    } else {
      // Redirigir a la Google Play Store
      window.open("https://play.google.com/store/apps/details?id=com.ticketapp");
      // window.location.replace("https://play.google.com/store/apps/details?id=com.ticketapp");
      // window.location.href = "https://play.google.com/store/apps/details?id=com.ticketapp";
    }
  }
  // Llamar a la funci칩n de redireccionamiento cuando se cargue la p치gina
  window.onload = redireccionar;
</script>
</body>
</html>
